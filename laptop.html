<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ноутбук Tralalelo - Удаленное подключение</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="no-scanline.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@300;400;700&display=swap');

        :root {
            --background-color: #0a0a0f;
            --terminal-bg: #121218;
            --text-color: #e0e0e0;
            --accent-color: #6bff9f;
            --secondary-accent: #ff006a;
            --terminal-glow: 0 0 10px rgba(107, 255, 159, 0.2);
            --font-main: 'JetBrains Mono', monospace;
            --success-color: #00cc66;
            --error-color: #ff3333;
            --warning-color: #ffcc00;
            --secondary-color: #0C2E35;
            --terminal-green: #4eff8a;
            --header-color: #1a1f26;
            --folder-color: #6bff9f;
            --file-color: #e0e0e0;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-main);
            background-color: var(--background-color);
            color: var(--text-color);
            line-height: 1.6;
            background-image: 
                radial-gradient(rgba(107, 255, 159, 0.1) 1px, transparent 1px),
                radial-gradient(rgba(107, 255, 159, 0.1) 1px, transparent 1px);
            background-size: 30px 30px;
            background-position: 0 0, 15px 15px;
            min-height: 100vh;
            position: relative;
            overflow-x: hidden;
        }

        body::before {
            content: "";
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(to bottom, rgba(10, 14, 18, 0.95), rgba(10, 14, 18, 0.85));
            z-index: -1;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 1rem;
            position: relative;
            z-index: 1;
            display: flex;
            flex-direction: column;
            height: 100vh;
        }

        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background-color: var(--header-color);
            padding: 1rem;
            border-bottom: 1px solid rgba(107, 255, 159, 0.2);
            margin-bottom: 1rem;
        }

        .header-left {
            flex: 1;
        }

        .header-center {
            flex: 2;
            text-align: center;
        }

        .header-right {
            flex: 1;
            text-align: right;
            display: flex;
            justify-content: flex-end;
            align-items: center;
            gap: 15px;
        }

        h1 {
            font-size: 1.5rem;
            font-weight: 700;
            letter-spacing: 2px;
            text-shadow: 0 0 10px rgba(107, 255, 159, 0.7);
        }

        .accent {
            color: var(--accent-color);
        }

        .back-button {
            display: inline-block;
            color: var(--text-color);
            text-decoration: none;
            font-size: 0.9rem;
            transition: color 0.3s ease;
        }

        .back-button:hover {
            color: var(--accent-color);
        }

        .time-display {
            font-family: var(--font-main);
            font-size: 1rem;
            color: var(--accent-color);
        }

        main {
            display: flex;
            flex: 1;
            gap: 1rem;
            overflow: hidden;
        }

        .desktop {
            flex: 3;
            background-color: rgba(6, 20, 24, 0.8);
            border-radius: 5px;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            backdrop-filter: blur(4px);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(107, 255, 159, 0.2);
            padding: 1rem;
        }

        .desktop-icons {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            grid-gap: 20px;
            margin-top: 1rem;
        }

        .icon {
            display: flex;
            flex-direction: column;
            align-items: center;
            cursor: pointer;
            padding: 10px;
            border-radius: 5px;
            transition: background-color 0.3s ease;
        }

        .icon:hover {
            background-color: rgba(107, 255, 159, 0.1);
        }

        .icon i {
            font-size: 2.5rem;
            margin-bottom: 8px;
            color: var(--accent-color);
        }

        .icon-label {
            text-align: center;
            font-size: 0.8rem;
            color: var(--text-color);
        }

        .note-window {
            display: none;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 80%;
            max-width: 800px;
            background-color: var(--terminal-bg);
            border-radius: 5px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            border: 1px solid var(--accent-color);
            z-index: 100;
        }

        .note-header {
            background-color: var(--header-color);
            padding: 0.8rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid rgba(107, 255, 159, 0.2);
        }

        .note-title {
            font-size: 1rem;
            color: var(--accent-color);
        }

        .note-controls i {
            margin-left: 10px;
            font-size: 0.9rem;
            color: var(--text-color);
            cursor: pointer;
            transition: opacity 0.3s ease;
        }

        .note-controls i:hover {
            opacity: 0.7;
        }

        .note-content {
            padding: 1.5rem;
            font-size: 0.95rem;
            line-height: 1.7;
            max-height: 60vh;
            overflow-y: auto;
        }

        .file-browser {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 80%;
            max-width: 800px;
            background-color: var(--terminal-bg);
            border-radius: 5px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            border: 1px solid var(--accent-color);
            z-index: 100;
            display: none;
        }

        .file-browser-header {
            background-color: var(--header-color);
            padding: 0.8rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid rgba(107, 255, 159, 0.2);
        }

        .file-browser-title {
            font-size: 1rem;
            color: var(--accent-color);
        }

        .file-browser-controls i {
            margin-left: 10px;
            font-size: 0.9rem;
            color: var(--text-color);
            cursor: pointer;
            transition: opacity 0.3s ease;
        }

        .file-browser-controls i:hover {
            opacity: 0.7;
        }

        .file-browser-content {
            padding: 1rem;
            max-height: 60vh;
            overflow-y: auto;
        }

        .folders, .files {
            margin-bottom: 1.5rem;
        }

        .category-title {
            font-size: 0.9rem;
            margin-bottom: 0.8rem;
            color: var(--text-color);
            opacity: 0.7;
        }

        .folder-list, .file-list {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .folder-item, .file-item {
            display: flex;
            align-items: center;
            padding: 8px;
            border-radius: 4px;
            transition: background-color 0.3s ease;
            cursor: pointer;
        }

        .folder-item:hover, .file-item:hover {
            background-color: rgba(107, 255, 159, 0.1);
        }

        .folder-item i {
            color: var(--folder-color);
            margin-right: 10px;
            font-size: 1.2rem;
        }

        .file-item i {
            color: var(--file-color);
            margin-right: 10px;
            font-size: 1.2rem;
        }

        .folder-name, .file-name {
            font-size: 0.9rem;
        }

        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 99;
            display: none;
        }
        
        .taskbar {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background-color: var(--header-color);
            padding: 0.5rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-top: 1px solid rgba(107, 255, 159, 0.2);
            z-index: 10;
        }
        
        .start-menu {
            display: flex;
            align-items: center;
            padding: 5px 10px;
            background-color: rgba(107, 255, 159, 0.1);
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }
        
        .start-menu:hover {
            background-color: rgba(107, 255, 159, 0.2);
        }
        
        .start-menu i {
            color: var(--accent-color);
            margin-right: 8px;
        }
        
        .taskbar-right {
            display: flex;
            align-items: center;
            gap: 15px;
            font-size: 0.8rem;
        }

        /* Анимации */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .fade-in {
            animation: fadeIn 0.5s ease-in-out forwards;
        }

        .note-important {
            color: var(--warning-color);
            font-weight: bold;
        }
        
        /* Стили для почтового клиента */
        .mail-window {
            display: none;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 80%;
            max-width: 800px;
            background-color: var(--terminal-bg);
            border-radius: 5px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            border: 1px solid var(--accent-color);
            z-index: 100;
        }

        .mail-header {
            background-color: var(--header-color);
            padding: 0.8rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid rgba(107, 255, 159, 0.2);
        }

        .mail-title {
            font-size: 1rem;
            color: var(--accent-color);
        }

        .mail-controls i {
            margin-left: 10px;
            font-size: 0.9rem;
            color: var(--text-color);
            cursor: pointer;
            transition: opacity 0.3s ease;
        }

        .mail-controls i:hover {
            opacity: 0.7;
        }

        .mail-content {
            display: flex;
            height: 60vh;
        }

        .mail-sidebar {
            width: 30%;
            border-right: 1px solid rgba(107, 255, 159, 0.2);
            overflow-y: auto;
        }

        .mail-list {
            list-style: none;
        }

        .mail-item {
            padding: 1rem;
            border-bottom: 1px solid rgba(107, 255, 159, 0.2);
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        .mail-item:hover {
            background-color: rgba(107, 255, 159, 0.1);
        }

        .mail-item.active {
            background-color: rgba(107, 255, 159, 0.2);
        }

        .mail-item-sender {
            font-weight: bold;
            margin-bottom: 0.3rem;
        }

        .mail-item-subject {
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            margin-bottom: 0.3rem;
        }

        .mail-item-date {
            font-size: 0.8rem;
            color: rgba(224, 224, 224, 0.7);
        }

        .mail-body {
            width: 70%;
            padding: 1.5rem;
            overflow-y: auto;
        }

        .mail-view-header {
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid rgba(107, 255, 159, 0.2);
        }

        .mail-view-subject {
            font-size: 1.2rem;
            margin-bottom: 0.5rem;
            color: var(--accent-color);
        }

        .mail-view-info {
            display: flex;
            justify-content: space-between;
            font-size: 0.9rem;
        }

        .mail-view-from, .mail-view-to {
            margin-bottom: 0.3rem;
        }

        .mail-view-date {
            color: rgba(224, 224, 224, 0.7);
        }

        .mail-view-content {
            line-height: 1.6;
        }

        .mail-view-content p {
            margin-bottom: 1rem;
        }
        
        .mail-attachment {
            margin-top: 2rem;
            padding-top: 1rem;
            border-top: 1px solid rgba(107, 255, 159, 0.2);
        }
        
        .mail-attachment-title {
            font-size: 0.9rem;
            margin-bottom: 0.5rem;
            color: rgba(224, 224, 224, 0.7);
        }
        
        .mail-attachment-item {
            display: flex;
            align-items: center;
            padding: 0.5rem;
            background-color: rgba(107, 255, 159, 0.1);
            border-radius: 4px;
            cursor: pointer;
        }
        
        .mail-attachment-item i {
            margin-right: 0.5rem;
            color: var(--accent-color);
        }
        
        /* Стили для терминала */
        .terminal-window {
            display: none;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 70%;
            max-width: 700px;
            background-color: var(--terminal-bg);
            border-radius: 5px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            border: 1px solid var(--accent-color);
            z-index: 100;
        }
        
        .terminal-window-header {
            background-color: var(--header-color);
            padding: 0.8rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid rgba(107, 255, 159, 0.2);
        }
        
        .terminal-window-title {
            font-size: 1rem;
            color: var(--accent-color);
        }
        
        .terminal-window-controls i {
            margin-left: 10px;
            font-size: 0.9rem;
            color: var(--text-color);
            cursor: pointer;
            transition: opacity 0.3s ease;
        }
        
        .terminal-window-controls i:hover {
            opacity: 0.7;
        }
        
        .terminal-window-content {
            padding: 1rem;
            height: 50vh;
            overflow-y: auto;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.9rem;
            background-color: #000;
            color: var(--terminal-green);
        }
        
        .terminal-line {
            margin-bottom: 0.5rem;
            line-height: 1.5;
        }
        
        .terminal-input-line {
            display: flex;
        }
        
        .terminal-prompt {
            color: var(--accent-color);
            margin-right: 0.5rem;
        }
        
        .terminal-input {
            flex: 1;
            background: transparent;
            border: none;
            color: var(--terminal-green);
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.9rem;
            outline: none;
        }

        /* Стили для просмотра изображений */
        .image-viewer {
            display: none;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 80%;
            max-width: 800px;
            background-color: var(--terminal-bg);
            border-radius: 5px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            border: 1px solid var(--accent-color);
            z-index: 100;
        }
        
        .image-viewer-header {
            background-color: var(--header-color);
            padding: 0.8rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid rgba(107, 255, 159, 0.2);
        }
        
        .image-viewer-title {
            font-size: 1rem;
            color: var(--accent-color);
        }
        
        .image-viewer-controls i {
            margin-left: 10px;
            font-size: 0.9rem;
            color: var(--text-color);
            cursor: pointer;
            transition: opacity 0.3s ease;
        }
        
        .image-viewer-controls i:hover {
            opacity: 0.7;
        }
        
        .image-viewer-content {
            padding: 1.5rem;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .image-viewer-img {
            max-width: 100%;
            max-height: 60vh;
            margin-bottom: 1rem;
            border: 1px solid var(--accent-color);
        }
        
        .image-metadata {
            width: 100%;
            background-color: rgba(0, 0, 0, 0.3);
            padding: 1rem;
            border-radius: 4px;
            font-size: 0.8rem;
            font-family: 'JetBrains Mono', monospace;
        }
        
        .highlight {
            color: var(--accent-color);
            font-weight: bold;
        }

        /* Стили для мини-игры по взлому */
        .hacking-game {
            background-color: rgba(0, 0, 0, 0.9);
            padding: 20px;
            border: 1px solid var(--accent-color);
            margin-top: 10px;
            margin-bottom: 10px;
            border-radius: 5px;
        }

        .hacking-header {
            border-bottom: 1px solid var(--accent-color);
            padding-bottom: 10px;
            margin-bottom: 10px;
            color: var(--accent-color);
            font-weight: bold;
        }

        .hacking-progress {
            height: 20px;
            background-color: #111;
            border: 1px solid var(--accent-color);
            margin: 10px 0;
            position: relative;
        }

        .progress-bar {
            height: 100%;
            width: 0%;
            background-color: var(--accent-color);
            transition: width 0.5s linear;
        }

        .hacking-buttons {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-top: 15px;
        }

        .hack-btn {
            background-color: rgba(107, 255, 159, 0.1);
            border: 1px solid var(--accent-color);
            color: var(--accent-color);
            padding: 8px;
            cursor: pointer;
            transition: background-color 0.3s;
            font-family: 'JetBrains Mono', monospace;
        }

        .hack-btn:hover {
            background-color: rgba(107, 255, 159, 0.3);
        }

        .hack-btn.correct {
            background-color: rgba(0, 204, 102, 0.3);
        }

        .hack-btn.wrong {
            background-color: rgba(255, 51, 51, 0.3);
        }

        .hacking-status {
            margin-top: 10px;
            color: var(--accent-color);
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="header-left">
                <!-- Удаляем кнопку "Вернуться к чату" -->
            </div>
            <div class="header-center">
                <h1>НОУТБУК TRALA<span class="accent">LELO</span> - УДАЛЕННОЕ ПОДКЛЮЧЕНИЕ</h1>
            </div>
            <div class="header-right">
                <div class="time-display" id="current-time">00:00:00</div>
            </div>
        </header>
        
        <main>
            <div class="desktop">
                <div class="desktop-icons">
                    <div class="icon" id="notes-icon">
                        <i class="fas fa-sticky-note"></i>
                        <div class="icon-label">Заметки</div>
                    </div>
                    <div class="icon" id="browser-icon">
                        <i class="fas fa-globe"></i>
                        <div class="icon-label">Браузер</div>
                    </div>
                    <div class="icon" id="files-icon">
                        <i class="fas fa-folder"></i>
                        <div class="icon-label">Файлы</div>
                    </div>
                    <div class="icon" id="mail-icon">
                        <i class="fas fa-envelope"></i>
                        <div class="icon-label">Почта</div>
                    </div>
                    <div class="icon" id="terminal-icon">
                        <i class="fas fa-terminal"></i>
                        <div class="icon-label">Терминал</div>
                    </div>
                    <div class="icon" id="trash-icon">
                        <i class="fas fa-trash"></i>
                        <div class="icon-label">Корзина</div>
                    </div>
                </div>
            </div>
        </main>
        
        <div class="overlay" id="overlay"></div>
        
        <!-- Окно с заметкой -->
        <div class="note-window" id="note-window">
            <div class="note-header">
                <div class="note-title">Личные заметки - bobritto.txt</div>
                <div class="note-controls">
                    <i class="fas fa-minus"></i>
                    <i class="fas fa-expand"></i>
                    <i class="fas fa-times" id="close-note"></i>
                </div>
            </div>
            <div class="note-content">
                <p>Дата: 15.07.2023</p>
                <p>Мне кажется, что за мной следят. В последнее время замечаю странную активность на своих устройствах. Возможно, это паранойя, но лучше перестраховаться.</p>
                <p>Решил оставить некоторые подсказки о своем местонахождении на случай чрезвычайной ситуации.</p>
                <p class="note-important">ВАЖНО: Если читаешь это, значит что-то случилось. Боюсь, что Bobritto bandito может быть замешан. Он давно угрожал мне.</p>
                <p>Я отправляюсь в место, где "волны встречаются с кодом". Координаты зашифрованы в фотографии на моем телефоне. Ключ к шифру - моя любимая формула вероятности.</p>
                <p>P.S. Нашел какие-то странные следы около своего дома. Похожи на следы от ласт...</p>
            </div>
        </div>
        
        <!-- Окно файлового менеджера -->
        <div class="file-browser" id="file-browser">
            <div class="file-browser-header">
                <div class="file-browser-title">Файловый менеджер</div>
                <div class="file-browser-controls">
                    <i class="fas fa-minus"></i>
                    <i class="fas fa-expand"></i>
                    <i class="fas fa-times" id="close-files"></i>
                </div>
            </div>
            <div class="file-browser-content">
                <div class="folders">
                    <div class="category-title">Папки</div>
                    <div class="folder-list">
                        <div class="folder-item">
                            <i class="fas fa-folder"></i>
                            <div class="folder-name">Документы</div>
                        </div>
                        <div class="folder-item">
                            <i class="fas fa-folder"></i>
                            <div class="folder-name">Изображения</div>
                        </div>
                        <div class="folder-item">
                            <i class="fas fa-folder"></i>
                            <div class="folder-name">Проекты</div>
                        </div>
                        <div class="folder-item">
                            <i class="fas fa-folder"></i>
                            <div class="folder-name">Архивы</div>
                        </div>
                    </div>
                </div>
                
                <div class="files">
                    <div class="category-title">Файлы</div>
                    <div class="file-list">
                        <div class="file-item" id="note-link">
                            <i class="fas fa-file-alt"></i>
                            <div class="file-name">bobritto.txt</div>
                        </div>
                        <div class="file-item">
                            <i class="fas fa-file-image"></i>
                            <div class="file-name">пляж.jpg</div>
                        </div>
                        <div class="file-item">
                            <i class="fas fa-file-code"></i>
                            <div class="file-name">шифр.py</div>
                        </div>
                        <div class="file-item">
                            <i class="fas fa-file-pdf"></i>
                            <div class="file-name">отчет.pdf</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Окно почтового клиента -->
        <div class="mail-window" id="mail-window">
            <div class="mail-header">
                <div class="mail-title">Почтовый клиент - TralaMail</div>
                <div class="mail-controls">
                    <i class="fas fa-minus"></i>
                    <i class="fas fa-expand"></i>
                    <i class="fas fa-times" id="close-mail"></i>
                </div>
            </div>
            <div class="mail-content">
                <div class="mail-sidebar">
                    <ul class="mail-list">
                        <li class="mail-item" data-mail-id="1">
                            <div class="mail-item-sender">Bobritto Bandito</div>
                            <div class="mail-item-subject">Последнее предупреждение</div>
                            <div class="mail-item-date">14.07.2023</div>
                        </li>
                        <li class="mail-item" data-mail-id="2">
                            <div class="mail-item-sender">Система безопасности</div>
                            <div class="mail-item-subject">Обнаружена подозрительная активность</div>
                            <div class="mail-item-date">12.07.2023</div>
                        </li>
                        <li class="mail-item" data-mail-id="3">
                            <div class="mail-item-sender">Координационный центр</div>
                            <div class="mail-item-subject">Данные о новом задании</div>
                            <div class="mail-item-date">10.07.2023</div>
                        </li>
                        <li class="mail-item" data-mail-id="4">
                            <div class="mail-item-sender">Dr. Quackson</div>
                            <div class="mail-item-subject">Информация о прибрежной лаборатории</div>
                            <div class="mail-item-date">05.07.2023</div>
                        </li>
                    </ul>
                </div>
                <div class="mail-body">
                    <div class="mail-view" id="mail-view-1">
                        <div class="mail-view-header">
                            <div class="mail-view-subject">Последнее предупреждение</div>
                            <div class="mail-view-info">
                                <div>
                                    <div class="mail-view-from"><strong>От:</strong> Bobritto Bandito &lt;bobritto@darkweb.net&gt;</div>
                                    <div class="mail-view-to"><strong>Кому:</strong> Tralalelo Tralala &lt;tralalelo@golubmail.com&gt;</div>
                                </div>
                                <div class="mail-view-date">14.07.2023 22:47</div>
                            </div>
                        </div>
                        <div class="mail-view-content">
                            <p>Tralalelo,</p>
                            <p>Это моё последнее предупреждение. Вы слишком долго мешаете моим планам. Я знаю, что вы обнаружили информацию о моей подводной лаборатории.</p>
                            <p>Если вы не прекратите своё расследование, последствия будут серьёзными. Я не остановлюсь ни перед чем, чтобы защитить свой проект "Морской бобр".</p>
                            <p>У вас есть 24 часа, чтобы передать мне все данные, которые вы собрали. Иначе вы очень пожалеете.</p>
                            <p>Bobritto</p>
                        </div>
                    </div>
                    
                    <div class="mail-view" id="mail-view-2" style="display: none;">
                        <div class="mail-view-header">
                            <div class="mail-view-subject">Обнаружена подозрительная активность</div>
                            <div class="mail-view-info">
                                <div>
                                    <div class="mail-view-from"><strong>От:</strong> Система безопасности &lt;security@golubmail.com&gt;</div>
                                    <div class="mail-view-to"><strong>Кому:</strong> Tralalelo Tralala &lt;tralalelo@golubmail.com&gt;</div>
                                </div>
                                <div class="mail-view-date">12.07.2023 15:32</div>
                            </div>
                        </div>
                        <div class="mail-view-content">
                            <p>Уважаемый пользователь,</p>
                            <p>Наша система обнаружила попытку несанкционированного доступа к вашей учетной записи с IP-адреса 192.168.13.37.</p>
                            <p>Геолокация: Прибрежная зона, Бобровая бухта</p>
                            <p>Время попытки: 12.07.2023 14:55</p>
                            <p>Рекомендуем немедленно изменить пароль и активировать двухфакторную аутентификацию.</p>
                            <p>С уважением,<br>Служба безопасности GolubMail</p>
                        </div>
                    </div>
                    
                    <div class="mail-view" id="mail-view-3" style="display: none;">
                        <div class="mail-view-header">
                            <div class="mail-view-subject">Данные о новом задании</div>
                            <div class="mail-view-info">
                                <div>
                                    <div class="mail-view-from"><strong>От:</strong> Координационный центр &lt;center@golubpost.org&gt;</div>
                                    <div class="mail-view-to"><strong>Кому:</strong> Tralalelo Tralala &lt;tralalelo@golubmail.com&gt;</div>
                                </div>
                                <div class="mail-view-date">10.07.2023 09:13</div>
                            </div>
                        </div>
                        <div class="mail-view-content">
                            <p>Агент Tralala,</p>
                            <p>Вам поручается новое задание высшего приоритета:</p>
                            <p>Наша разведка обнаружила подозрительную активность вблизи Бобровой бухты. По предварительным данным, там ведётся строительство секретной подводной лаборатории.</p>
                            <p>Координаты для исследования: 41°24'12.2"N 2°10'26.5"E</p>
                            <p>Необходимо провести разведку и выяснить цель строительства. По нашим данным, за этим может стоять Bobritto Bandito.</p>
                            <p>Будьте предельно осторожны. Информация строго конфиденциальна.</p>
                            <p>С уважением,<br>Координационный центр</p>
                        </div>
                        <div class="mail-attachment">
                            <div class="mail-attachment-title">Вложения:</div>
                            <div class="mail-attachment-item" id="map-attachment">
                                <i class="fas fa-map"></i>
                                <span>карта_бухты.jpg</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mail-view" id="mail-view-4" style="display: none;">
                        <div class="mail-view-header">
                            <div class="mail-view-subject">Информация о прибрежной лаборатории</div>
                            <div class="mail-view-info">
                                <div>
                                    <div class="mail-view-from"><strong>От:</strong> Dr. Quackson &lt;quackson@science.edu&gt;</div>
                                    <div class="mail-view-to"><strong>Кому:</strong> Tralalelo Tralala &lt;tralalelo@golubmail.com&gt;</div>
                                </div>
                                <div class="mail-view-date">05.07.2023 11:45</div>
                            </div>
                        </div>
                        <div class="mail-view-content">
                            <p>Дорогой Tralalelo,</p>
                            <p>Я провел анализ полученных вами образцов воды из Бобровой бухты. Результаты вызывают серьезную тревогу.</p>
                            <p>В образцах обнаружены следы экспериментальной сыворотки, которая может изменять ДНК водных животных. Если мои расчеты верны, Bobritto пытается создать армию бобров-мутантов с амфибийными способностями.</p>
                            <p>Формула сыворотки основана на последовательности: C₂₁H₃₀O₂ с модификациями для водной среды. Это крайне опасно и может нарушить всю экосистему!</p>
                            <p>Необходимо остановить эксперименты как можно скорее. Код доступа к системе безопасности лаборатории должен основываться на базовой формуле вероятности, которую мы обсуждали на конференции.</p>
                            <p>Будьте осторожны. Bobritto очень опасен и непредсказуем.</p>
                            <p>Dr. Quackson</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Окно терминала -->
        <div class="terminal-window" id="terminal-window">
            <div class="terminal-window-header">
                <div class="terminal-window-title">Терминал - TralaShell</div>
                <div class="terminal-window-controls">
                    <i class="fas fa-minus"></i>
                    <i class="fas fa-expand"></i>
                    <i class="fas fa-times" id="close-terminal"></i>
                </div>
            </div>
            <div class="terminal-window-content" id="terminal-content">
                <div class="terminal-line">Welcome to TralaShell v2.3.5</div>
                <div class="terminal-line">© 2023 Tralalelo Tralala</div>
                <div class="terminal-line">Введите 'help' для списка команд</div>
                <div class="terminal-line">&nbsp;</div>
                <div class="terminal-input-line">
                    <span class="terminal-prompt">tralalelo@golubmail:~$</span>
                    <input type="text" class="terminal-input" id="terminal-input">
                </div>
            </div>
        </div>
        
        <!-- Просмотр изображений -->
        <div class="image-viewer" id="image-viewer">
            <div class="image-viewer-header">
                <div class="image-viewer-title" id="image-title">Просмотр изображения</div>
                <div class="image-viewer-controls">
                    <i class="fas fa-minus"></i>
                    <i class="fas fa-expand"></i>
                    <i class="fas fa-times" id="close-image"></i>
                </div>
            </div>
            <div class="image-viewer-content">
                <img src="beach_map.jpg" alt="Карта бухты" class="image-viewer-img" id="viewer-image">
                <div class="image-metadata" id="image-metadata">
                    <p>Имя файла: карта_бухты.jpg</p>
                    <p>Размер: 1.2 MB</p>
                    <p>Дата создания: 10.07.2023</p>
                    <p>GPS координаты: <span class="highlight">41°24'12.2"N 2°10'26.5"E</span></p>
                    <p>Метаданные: <span class="highlight">подводная_лаборатория, проект_морской_бобр, вход_с_пляжа</span></p>
                </div>
            </div>
        </div>
        
        <div class="taskbar">
            <div class="start-menu">
                <i class="fas fa-th-large"></i>
                <span>Меню</span>
            </div>
            <div class="taskbar-right">
                <div id="taskbar-time">00:00</div>
                <i class="fas fa-wifi"></i>
                <i class="fas fa-volume-up"></i>
                <i class="fas fa-battery-three-quarters"></i>
            </div>
        </div>
    </div>
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Обновление времени
            function updateTime() {
                const now = new Date();
                const hours = now.getHours().toString().padStart(2, '0');
                const minutes = now.getMinutes().toString().padStart(2, '0');
                const seconds = now.getSeconds().toString().padStart(2, '0');
                
                // Обновляем время в шапке
                document.getElementById('current-time').textContent = `${hours}:${minutes}:${seconds}`;
                
                // Обновляем время в тулбаре
                document.getElementById('taskbar-time').textContent = `${hours}:${minutes}`;
            }
            
            // Обновляем время каждую секунду
            updateTime();
            setInterval(updateTime, 1000);
            
            // Получаем ссылки на элементы DOM
            const overlay = document.getElementById('overlay');
            const notesIcon = document.getElementById('notes-icon');
            const filesIcon = document.getElementById('files-icon');
            const mailIcon = document.getElementById('mail-icon');
            const terminalIcon = document.getElementById('terminal-icon');
            
            const noteWindow = document.getElementById('note-window');
            const closeNote = document.getElementById('close-note');
            const fileBrowser = document.getElementById('file-browser');
            const closeFiles = document.getElementById('close-files');
            const mailWindow = document.getElementById('mail-window');
            const closeMail = document.getElementById('close-mail');
            const terminalWindow = document.getElementById('terminal-window');
            const closeTerminal = document.getElementById('close-terminal');
            const imageViewer = document.getElementById('image-viewer');
            const closeImage = document.getElementById('close-image');
            
            const noteLink = document.getElementById('note-link');
            const mailItems = document.querySelectorAll('.mail-item');
            const mailViews = document.querySelectorAll('.mail-view');
            const mapAttachment = document.getElementById('map-attachment');
            const terminalInput = document.getElementById('terminal-input');
            
            // Функция открытия заметки
            function openNote() {
                hideAllWindows();
                overlay.style.display = 'block';
                noteWindow.style.display = 'block';
            }
            
            // Функция закрытия заметки
            function closeNoteWindow() {
                overlay.style.display = 'none';
                noteWindow.style.display = 'none';
            }
            
            // Функция открытия файлового менеджера
            function openFileBrowser() {
                hideAllWindows();
                overlay.style.display = 'block';
                fileBrowser.style.display = 'block';
            }
            
            // Функция закрытия файлового менеджера
            function closeFileBrowser() {
                overlay.style.display = 'none';
                fileBrowser.style.display = 'none';
            }
            
            // Функция открытия почтового клиента
            function openMail() {
                hideAllWindows();
                overlay.style.display = 'block';
                mailWindow.style.display = 'block';
            }
            
            // Функция закрытия почтового клиента
            function closeMailWindow() {
                overlay.style.display = 'none';
                mailWindow.style.display = 'none';
            }
            
            // Функция открытия терминала
            function openTerminal() {
                hideAllWindows();
                overlay.style.display = 'block';
                terminalWindow.style.display = 'block';
                terminalInput.focus();
            }
            
            // Функция закрытия терминала
            function closeTerminalWindow() {
                overlay.style.display = 'none';
                terminalWindow.style.display = 'none';
            }
            
            // Функция открытия просмотра изображений
            function openImageViewer() {
                hideAllWindows();
                overlay.style.display = 'block';
                imageViewer.style.display = 'block';
            }
            
            // Функция закрытия просмотра изображений
            function closeImageViewer() {
                overlay.style.display = 'none';
                imageViewer.style.display = 'none';
            }
            
            // Функция для скрытия всех окон
            function hideAllWindows() {
                noteWindow.style.display = 'none';
                fileBrowser.style.display = 'none';
                mailWindow.style.display = 'none';
                terminalWindow.style.display = 'none';
                imageViewer.style.display = 'none';
            }
            
            // Обработчики событий для открытия окон
            notesIcon.addEventListener('click', openNote);
            filesIcon.addEventListener('click', openFileBrowser);
            mailIcon.addEventListener('click', openMail);
            terminalIcon.addEventListener('click', openTerminal);
            
            // Обработчики событий для закрытия окон
            closeNote.addEventListener('click', closeNoteWindow);
            closeFiles.addEventListener('click', closeFileBrowser);
            closeMail.addEventListener('click', closeMailWindow);
            closeTerminal.addEventListener('click', closeTerminalWindow);
            closeImage.addEventListener('click', closeImageViewer);
            
            // Открытие заметки из файлового менеджера
            noteLink.addEventListener('click', () => {
                closeFileBrowser();
                openNote();
            });
            
            // Обработка выбора письма в почтовом клиенте
            mailItems.forEach(item => {
                item.addEventListener('click', () => {
                    const mailId = item.getAttribute('data-mail-id');
                    
                    // Удаляем активный класс у всех писем
                    mailItems.forEach(mi => mi.classList.remove('active'));
                    // Добавляем активный класс выбранному письму
                    item.classList.add('active');
                    
                    // Скрываем все представления писем
                    mailViews.forEach(view => {
                        view.style.display = 'none';
                    });
                    
                    // Показываем выбранное письмо
                    document.getElementById(`mail-view-${mailId}`).style.display = 'block';
                });
            });
            
            // Открытие карты из вложения
            mapAttachment.addEventListener('click', openImageViewer);
            
            // Обработка команд терминала
            terminalInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    const command = terminalInput.value.trim().toLowerCase();
                    const terminalContent = document.getElementById('terminal-content');
                    
                    // Создаем новую строку с введенной командой
                    const commandLine = document.createElement('div');
                    commandLine.classList.add('terminal-line');
                    commandLine.innerHTML = `<span class="terminal-prompt">tralalelo@golubmail:~$</span> ${command}`;
                    
                    // Добавляем строку с командой в терминал
                    terminalContent.insertBefore(commandLine, document.querySelector('.terminal-input-line'));
                    
                    // Обрабатываем команду и добавляем ответ
                    let response = '';
                    
                    if (command === 'help') {
                        response = `
                            Доступные команды:<br>
                            help - показать список команд<br>
                            ls - показать файлы в текущей директории<br>
                            cat [file] - показать содержимое файла<br>
                            clear - очистить терминал<br>
                            scan - сканировать сеть на наличие устройств<br>
                            connect [ip] - подключиться к удаленному серверу<br>
                            hack - запустить инструмент взлома
                        `;
                    } else if (command === 'ls') {
                        response = `
                            <span style="color: var(--accent-color);">Desktop/</span><br>
                            <span style="color: var(--accent-color);">Documents/</span><br>
                            <span style="color: var(--accent-color);">hacker_tools/</span><br>
                            bobritto_notes.txt<br>
                            missing_agent.txt
                        `;
                    } else if (command.startsWith('cat ')) {
                        const fileName = command.substring(4);
                        if (fileName === 'bobritto_notes.txt') {
                            response = `
                                <span style="color: var(--warning-color);">СОДЕРЖИМОЕ ФАЙЛА:</span><br>
                                Последние наблюдения за Bobritto bandito:<br>
                                <br>
                                - Активность в районе Бобровой бухты<br>
                                - Подозрительные серверы на IP 192.168.13.37<br>
                                - Возможная подводная лаборатория<br>
                                <br>
                                Если удастся получить доступ к его серверу, можно будет найти Tralalelo.
                            `;
                        } else if (fileName === 'missing_agent.txt') {
                            response = `
                                <span style="color: var(--warning-color);">СОДЕРЖИМОЕ ФАЙЛА:</span><br>
                                Tralalelo пропал после того, как отправился исследовать деятельность Bobritto bandito.<br>
                                <br>
                                Последнее сообщение: "Я нашел его сервер. Попробую взломать и получить данные.<br>
                                Если со мной что-то случится, вам нужно будет сделать то же самое. IP: 192.168.13.37"
                            `;
                        } else {
                            response = `Файл ${fileName} не найден или недоступен для чтения.`;
                        }
                    } else if (command === 'clear') {
                        // Очищаем терминал, оставляя только строку ввода
                        while (terminalContent.firstChild !== document.querySelector('.terminal-input-line')) {
                            terminalContent.removeChild(terminalContent.firstChild);
                        }
                    } else if (command === 'scan') {
                        response = `
                            <span style="color: var(--accent-color);">Сканирование сети...</span><br>
                            <br>
                            <span style="color: var(--success-color);">Обнаружены устройства:</span><br>
                            192.168.1.1 - Роутер<br>
                            192.168.1.2 - Ноутбук Tralalelo<br>
                            192.168.13.37 - <span style="color: var(--warning-color);">Неизвестное устройство [Сервер Bobritto]</span><br>
                            <br>
                            <span style="color: var(--warning-color);">Предупреждение:</span> Доступ к серверу 192.168.13.37 защищен. Используйте инструмент взлома.
                        `;
                    } else if (command === 'connect 192.168.13.37') {
                        response = `
                            <span style="color: var(--accent-color);">Подключение к 192.168.13.37...</span><br>
                            <br>
                            <span style="color: var(--error-color);">ДОСТУП ЗАПРЕЩЕН</span><br>
                            Требуется авторизация<br>
                            <br>
                            <span style="color: var(--warning-color);">Подсказка:</span> Используйте команду "hack" для взлома системы защиты.
                        `;
                    } else if (command === 'hack') {
                        // Запускаем мини-игру для взлома
                        response = `
                            <span style="color: var(--accent-color);">Запуск инструмента взлома...</span><br>
                            <br>
                            <span style="color: var(--warning-color);">Обнаружена защита от несанкционированного доступа</span><br>
                            Для взлома необходимо последовательно подобрать элементы защиты<br>
                            <br>
                            <div class="hacking-game" id="hacking-game">
                                <div class="hacking-header">СИСТЕМА ВЗЛОМА v2.3</div>
                                <div>Найдите правильную последовательность для взлома:</div>
                                <div class="hacking-progress">
                                    <div class="progress-bar" id="hack-progress"></div>
                                </div>
                                <div class="hacking-status" id="hack-status">Готово к взлому. Выберите первый элемент последовательности.</div>
                                <div class="hacking-buttons" id="hack-buttons">
                                    <!-- Кнопки будут добавлены через JS -->
                                </div>
                            </div>
                        `;
                        
                        // Добавляем ответ сразу, а потом инициализируем игру
                        const responseLine = document.createElement('div');
                        responseLine.classList.add('terminal-line');
                        responseLine.innerHTML = response;
                        terminalContent.insertBefore(responseLine, document.querySelector('.terminal-input-line'));
                        
                        // Прокручиваем вниз
                        terminalContent.scrollTop = terminalContent.scrollHeight;
                        
                        // Инициализируем игру после добавления элементов в DOM
                        setTimeout(() => {
                            initHackingGame();
                        }, 100);
                        
                        // Сбрасываем флаг, чтобы не добавлять ответ дважды
                        response = '';
                    } else if (command.startsWith('connect')) {
                        const ip = command.substring(8).trim();
                        if (ip) {
                            response = `
                                <span style="color: var(--accent-color);">Подключение к ${ip}...</span><br>
                                <br>
                                <span style="color: var(--error-color);">Ошибка подключения:</span> Хост недоступен или не существует.
                            `;
                        } else {
                            response = `
                                <span style="color: var(--error-color);">Ошибка:</span> Укажите IP адрес для подключения.
                                Пример: connect 192.168.1.1
                            `;
                        }
                    } else {
                        response = `
                            <span style="color: var(--error-color);">Команда не найдена:</span> ${command}<br>
                            Используйте <span style="color: var(--accent-color);">help</span> для просмотра доступных команд
                        `;
                    }
                    
                    // Добавляем ответ, если он есть
                    if (response) {
                        const responseLine = document.createElement('div');
                        responseLine.classList.add('terminal-line');
                        responseLine.innerHTML = response;
                        terminalContent.insertBefore(responseLine, document.querySelector('.terminal-input-line'));
                    }
                    
                    // Очищаем поле ввода и прокручиваем вниз
                    terminalInput.value = '';
                    terminalContent.scrollTop = terminalContent.scrollHeight;
                }
            });
            
            // Функция для инициализации мини-игры взлома
            function initHackingGame() {
                const hackButtons = document.getElementById('hack-buttons');
                const hackStatus = document.getElementById('hack-status');
                const hackProgress = document.getElementById('hack-progress');
                
                // Очищаем кнопки
                hackButtons.innerHTML = '';
                
                // Настройки игры
                const totalSteps = 4;
                let currentStep = 0;
                let hackComplete = false;
                
                // Символы для кнопок
                const symbols = ['&', '%', '#', '@', '*', '$', '!', '?', '+'];
                const correctSequence = []; // Хранение правильной последовательности
                
                // Создаем сетку 3x3 для кнопок взлома
                for (let i = 0; i < 9; i++) {
                    const btn = document.createElement('button');
                    btn.classList.add('hack-btn');
                    
                    // Назначаем символ
                    btn.textContent = symbols[i];
                    
                    // Добавляем обработчик события
                    btn.addEventListener('click', () => handleHackingChoice(btn, i));
                    
                    // Добавляем кнопку
                    hackButtons.appendChild(btn);
                }
                
                // Генерируем случайную правильную последовательность из 4 элементов
                for (let i = 0; i < totalSteps; i++) {
                    let randomIndex;
                    do {
                        randomIndex = Math.floor(Math.random() * 9);
                    } while (correctSequence.includes(randomIndex));
                    correctSequence.push(randomIndex);
                }
                
                // Функция для обработки выбора в мини-игре
                function handleHackingChoice(button, index) {
                    // Если взлом уже завершен, ничего не делаем
                    if (hackComplete) return;
                    
                    if (index === correctSequence[currentStep]) {
                        // Правильный выбор
                        button.classList.add('correct');
                        currentStep++;
                        
                        // Обновляем прогресс
                        const progressPercent = (currentStep / totalSteps) * 100;
                        hackProgress.style.width = `${progressPercent}%`;
                        
                        if (currentStep < totalSteps) {
                            hackStatus.textContent = `Правильно! Выберите следующий элемент (${currentStep+1}/${totalSteps})`;
                        } else {
                            // Взлом успешен
                            hackComplete = true;
                            hackStatus.innerHTML = '<span style="color: var(--success-color);">ДОСТУП ПОЛУЧЕН! Генерирую ключ безопасности...</span>';
                            
                            // Ждем немного для эффекта и показываем результат
                            setTimeout(() => {
                                const terminalContent = document.getElementById('terminal-content');
                                const hackingGame = document.getElementById('hacking-game');
                                
                                // Генерируем 35-символьный ключ безопасности
                                const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
                                let securityKey = '';
                                for (let i = 0; i < 35; i++) {
                                    securityKey += chars.charAt(Math.floor(Math.random() * chars.length));
                                }
                                
                                // Форматируем ключ для лучшей читаемости (группы по 5 символов)
                                const formattedKey = securityKey.match(/.{1,5}/g).join('-');
                                
                                // Добавляем информацию о ключе
                                hackingGame.innerHTML += `
                                    <div style="margin-top: 20px; border-top: 1px solid var(--accent-color); padding-top: 10px;">
                                        <div style="color: var(--success-color); margin-bottom: 5px;">ВЗЛОМ УСПЕШЕН!</div>
                                        <div>Ключ безопасности Bobritto:</div>
                                        <div style="background: #000; padding: 10px; margin: 10px 0; color: var(--accent-color); font-weight: bold; letter-spacing: 1px;">
                                            ${formattedKey}
                                        </div>
                                        <div style="color: var(--warning-color);">ВНИМАНИЕ: Это ключ к системам безопасности Bobritto. Относитесь к нему с осторожностью.</div>
                                    </div>
                                `;
                                
                                // Добавляем сообщение о том, что Bobritto свяжется с игроком
                                const responseLine = document.createElement('div');
                                responseLine.classList.add('terminal-line');
                                responseLine.innerHTML = `
                                    <br>
                                    <span style="color: var(--error-color);">ТРЕВОГА: Обнаружен несанкционированный доступ!</span><br>
                                    <span style="color: var(--warning-color);">Система безопасности оповещает владельца о взломе...</span><br>
                                    <br>
                                    <span style="color: var(--success-color);">Зафиксировано местоположение пропавшего агента:</span><br>
                                    Подводная лаборатория, координаты: 41°24'12.2"N 2°10'26.5"E<br>
                                    <br>
                                    <span style="color: var(--accent-color);">[Для продолжения вернитесь в основной чат]</span>
                                `;
                                terminalContent.insertBefore(responseLine, document.querySelector('.terminal-input-line'));
                                
                                // Прокручиваем вниз
                                terminalContent.scrollTop = terminalContent.scrollHeight;
                                
                                // Сохраняем ключ в localStorage для использования в основном чате
                                localStorage.setItem('bobrittoSecurityKey', formattedKey);
                                localStorage.setItem('hackComplete', 'true');
                                
                                // Сообщаем основному окну, что взлом завершен
                                if (window.opener) {
                                    window.opener.postMessage({ type: 'hackComplete', key: formattedKey }, '*');
                                }
                            }, 1500);
                        }
                    } else {
                        // Неправильный выбор
                        button.classList.add('wrong');
                        
                        // Сбрасываем прогресс
                        currentStep = 0;
                        hackProgress.style.width = '0%';
                        hackStatus.textContent = 'Неверный выбор! Начните заново.';
                        
                        // Сбрасываем все кнопки через небольшую задержку
                        setTimeout(() => {
                            document.querySelectorAll('.hack-btn').forEach(btn => {
                                btn.classList.remove('correct', 'wrong');
                            });
                        }, 800);
                    }
                }
            }
            
            // Закрытие окон при клике на оверлей
            overlay.addEventListener('click', () => {
                hideAllWindows();
                overlay.style.display = 'none';
            });
            
            // Предотвращаем закрытие окон при клике на них самих
            noteWindow.addEventListener('click', (e) => e.stopPropagation());
            fileBrowser.addEventListener('click', (e) => e.stopPropagation());
            mailWindow.addEventListener('click', (e) => e.stopPropagation());
            terminalWindow.addEventListener('click', (e) => e.stopPropagation());
            imageViewer.addEventListener('click', (e) => e.stopPropagation());
            
            // Имитация запуска системы
            setTimeout(() => {
                document.body.classList.add('fade-in');
            }, 500);
            
            // Выбираем первое письмо по умолчанию
            mailItems[0].classList.add('active');
            mailViews[0].style.display = 'block';

            // Добавляем обработчик сообщений от основного окна
            window.addEventListener('message', (event) => {
                // Проверяем источник сообщения для безопасности
                if (event.data && event.data.type === 'openLaptop') {
                    // Здесь можно добавить любые действия при открытии ноутбука из основного чата
                }
            });
            
            // Добавляем функцию для возврата в основной чат
            function returnToMainChat() {
                if (window.opener) {
                    window.opener.focus();
                    // Если нужно, можно передать сообщение основному окну
                    window.opener.postMessage({ type: 'returnFromLaptop' }, '*');
                    // Закрываем окно ноутбука
                    window.close();
                }
            }

            // Добавляем обработчик для текста "вернитесь в основной чат"
            document.addEventListener('DOMContentLoaded', function() {
                // Находим все элементы, которые могут содержать текст о возврате в чат
                const allElements = document.querySelectorAll('div, p, span');
                let chatReturnText = null;
                
                // Перебираем все элементы и ищем нужный текст
                for (const el of allElements) {
                    if (el.textContent && el.textContent.includes("[Для продолжения вернитесь в основной чат]")) {
                        chatReturnText = el;
                        break;
                    }
                }
                
                if (chatReturnText) {
                    chatReturnText.style.cursor = 'pointer';
                    chatReturnText.style.textDecoration = 'underline';
                    chatReturnText.addEventListener('click', function() {
                        // Отправляем сообщение родительскому окну (основному чату)
                        window.opener.postMessage({
                            type: 'terminalDataFound',
                            data: {
                                coordinates: "41°24'12.2\"N 2°10'26.5\"E",
                                message: "Найдены координаты подводной лаборатории"
                            }
                        }, '*');
                        
                        // Также можем выделить этот текст для привлечения внимания
                        chatReturnText.style.color = '#00ff00';
                        chatReturnText.style.fontWeight = 'bold';
                    });
                }
            });
        });
    </script>
</body>
</html> 